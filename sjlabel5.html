<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>SJ X N41 music - Artist Management</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        :root {
            --color-red: #ff0000;
            --color-white: #ffffff;
            --color-dark: #0a0a0a;
            --color-dark-transparent: #0a0a0af2;
            --color-dark-transparent-alt: #1a1a1ad9;
            --color-dark-light: #1a1a1a;
            --space-unit: 8px;
            --space-1: calc(1 * var(--space-unit));
            --space-2: calc(2 * var(--space-unit));
            --space-3: calc(3 * var(--space-unit));
            --space-4: calc(4 * var(--space-unit));
        }

        body {
            background: linear-gradient(135deg, #050608, #101218, #090c14);
            color: var(--color-white);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .glass-effect {
            background: linear-gradient(135deg, var(--color-dark-transparent), var(--color-dark-transparent-alt));
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border-radius: 20px;
        }

        .top-social-bar {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: var(--space-2) 0;
            transition: transform 0.3s ease;
        }
        .top-social-bar.hidden { transform: translateY(-100%); }
        .top-social-links a {
            color: var(--color-white);
            margin: 0 var(--space-1);
            font-size: 1.5rem;
            transition: color 0.3s ease, transform 0.3s ease;
        }
        .top-social-links a:hover { color: var(--color-red); transform: scale(1.2); }

        .hero-section { position: relative; height: 100vh; width: 100vw; overflow: hidden; display: flex; align-items: center; justify-content: center; z-index: 1; }
        .hero-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; transform: scale(1.05); transition: transform 0.3s ease; z-index: -1; }
        .carousel-item { height: 100vh; background-size: cover; background-position: center; position: relative; transition: opacity 0.5s ease; }
        .carousel-item.active { opacity: 1; }
        .carousel-item:not(.active) { opacity: 0; position: absolute; top: 0; left: 0; }
        .carousel-caption { background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(15px); border-radius: 20px; padding: var(--space-3); max-width: 80%; text-align: center; transform: translateY(20px); opacity: 0; transition: opacity 0.5s ease, transform 0.5s ease; }
        .carousel-item.active .carousel-caption { opacity: 1; transform: translateY(0); }
        .carousel-caption h1 { font-size: 2.5rem; font-weight: 700; letter-spacing: 1.5px; margin-bottom: var(--space-1); }
        .carousel-caption p { font-size: 1.1rem; opacity: 0.9; }
        .carousel-caption a { color: var(--color-red); text-decoration: none; font-weight: 600; transition: color 0.3s ease; }
        .carousel-caption a:hover { color: var(--color-white); }
        .carousel-control-prev, .carousel-control-next { width: 10%; background: rgba(0, 0, 0, 0.3); transition: background 0.3s ease; }
        .carousel-control-prev:hover, .carousel-control-next:hover { background: rgba(0, 0, 0, 0.5); }
        .carousel-control-prev-icon, .carousel-control-next-icon { filter: invert(1); }

        .music-platforms-bar {
            position: absolute; bottom: 8%; left: 50%; transform: translateX(-50%);
            display: flex; gap: var(--space-2); padding: var(--space-1) var(--space-2);
            background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px); border-radius: 50px; z-index: 2;
        }
        .music-platforms-bar a { color: var(--color-white); font-size: 1.6rem; transition: transform 0.3s ease; }
        .music-platforms-bar a:hover { transform: scale(1.2); }

        .artist-card {
            background: linear-gradient(135deg, var(--color-dark-transparent), var(--color-dark-transparent-alt));
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: var(--space-2); margin: var(--space-1);
            position: relative; transition: transform 0.3s ease, box-shadow 0.3s ease; overflow: hidden;
        }
        .artist-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2); }
        .artist-card img { width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: var(--space-1); }
        .artist-card h5 { color: var(--color-red); font-weight: 600; letter-spacing: 1px; font-size: 1.3rem; }
        .artist-card p { opacity: 0.8; font-size: 0.95rem; }
        .social-links a { color: var(--color-white); margin-right: var(--space-1); font-size: 1.4rem; transition: color 0.3s ease; }
        .social-links a:hover { color: var(--color-red); }
        .admin-actions { position: absolute; top: var(--space-1); right: var(--space-1); opacity: 0; transition: opacity 0.3s ease; }
        .artist-card:hover .admin-actions { opacity: 1; }
        .admin-actions button { background: none; border: none; color: var(--color-white); margin-left: 5px; cursor: pointer; font-size: 1.2rem; }
        .admin-actions button:hover { color: var(--color-red); }

        .form-control, .form-control:focus {
            background: rgba(255, 255, 255, 0.05); border: 1px solid var(--color-red); color: var(--color-white);
            border-radius: 10px; padding: 12px; font-size: 1rem;
        }
        .form-control::placeholder { color: rgba(255, 255, 255, 0.5); }
        .btn-primary {
            background: linear-gradient(135deg, var(--color-red) 0%, #cc0000 100%); border: none; border-radius: 25px;
            padding: 14px 30px; font-weight: 600; font-size: 1rem; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4); background: linear-gradient(135deg, #cc0000 0%, var(--color-red) 100%); }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); border: none; border-radius: 25px; padding: 14px 30px; font-size: 1rem; }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); }

        .modal-content { background: var(--color-dark-light); color: var(--color-white); border-radius: 20px; }
        .modal-header, .modal-footer { border-color: var(--color-red); }
        .btn-close-white { filter: invert(1); }

        .site-footer { text-align: center; padding: var(--space-3); background: linear-gradient(135deg, var(--color-dark-transparent), var(--color-dark-transparent-alt)); border-top: 1px solid rgba(255, 255, 255, 0.1); }
        .site-footer a { color: var(--color-red); text-decoration: none; transition: color 0.3s ease; }
        .site-footer a:hover { color: var(--color-white); }

        .particles { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        .particle { position: absolute; background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0) 70%); border-radius: 50%; }

        .ad-container-wrapper { display: flex; justify-content: center; margin: var(--space-2) auto; }
        #ad-container { width: 468px; height: 60px; max-width: 100%; }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .stagger-item { opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease, transform 0.5s ease; }
        .stagger-item.enhanced-appear { opacity: 1; transform: translateY(0); }

        @media (max-width: 768px) {
            .hero-section { height: 80vh; }
            .carousel-item { height: 80vh; }
            .carousel-caption { padding: var(--space-2); max-width: 90%; border-radius: 15px; }
            .carousel-caption h1 { font-size: 1.8rem; }
            .music-platforms-bar { bottom: 5%; gap: var(--space-1); padding: 10px 20px; }
            .music-platforms-bar a { font-size: 1.4rem; }
            .top-social-links a { font-size: 1.3rem; margin: 0 10px; }
            .artist-card { margin: var(--space-1) 0; padding: var(--space-1); }
            .artist-card img { height: 180px; }
            .form-section { margin: var(--space-2); padding: var(--space-1); max-width: 95%; }
            .admin-actions { position: static; opacity: 1; margin-top: var(--space-1); display: flex; justify-content: flex-end; }
        }
    </style>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
        import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc, getDoc, serverTimestamp, query, orderBy, where } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD-sneIBO65i9uQIh3n_jw4MI7GQtjZfV8",
            authDomain: "sj-one.firebaseapp.com",
            projectId: "sj-one",
            storageBucket: "sj-one.appspot.com",
            messagingSenderId: "426335553508",
            appId: "1:426335553508:web:248f76772f6f78419ca9f1"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const provider = new GoogleAuthProvider();

        const ADMIN_EMAIL = 'simo.jibou@gmail.com';
        let currentUser = null;
        let editingArtistId = null;
        let editingSliderId = null;

        // DOM Elements
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const userInfo = document.getElementById('user-info');
        const artistsList = document.getElementById('artists-list');
        const adminSection = document.getElementById('admin-section');
        const artistManagementSection = document.getElementById('artist-management-section');
        const submissionSection = document.getElementById('submission-section');
        const earningsCheckSection = document.getElementById('earnings-check-section');
        const adminEarningsSection = document.getElementById('admin-earnings-section');

        // === EARNINGS FUNCTIONS ===
        window.updateArtistEarnings = async (artistId) => {
            if (!currentUser || currentUser.email !== ADMIN_EMAIL) return alert('Admin only');
            const q = query(collection(db, 'artistSecrets'), where('artistId', '==', artistId), limit(1));
            const snap = await getDocs(q);
            if (snap.empty) return alert('No earnings data');
            const secretDoc = snap.docs[0];
            const data = secretDoc.data();
            const earnings = data.views / 1000;
            await updateDoc(secretDoc.ref, { amount: earnings });
            alert(`Earnings updated: $${earnings.toFixed(2)}`);
            loadAdminEarnings();
        };

        window.checkEarnings = async () => {
            const code = document.getElementById('secret-code').value.trim();
            if (!code) return alert('Enter secret code');
            const secretRef = doc(db, 'artistSecrets', code);
            const snap = await getDoc(secretRef);
            if (!snap.exists()) {
                document.getElementById('earnings-result').innerHTML = `<div class="alert alert-danger">Invalid code</div>`;
                return;
            }
            const data = snap.data();
            const artistSnap = await getDoc(doc(db, 'artists', data.artistId));
            const artist = artistSnap.exists() ? artistSnap.data() : { name: 'Unknown' };
            document.getElementById('earnings-result').innerHTML = `
                <div class="card glass-effect mt-3 text-center p-3">
                    <h5>${artist.name}</h5>
                    <p><strong>Views:</strong> ${data.views.toLocaleString()}</p>
                    <p><strong>Earnings:</strong> <span class="text-success">$${data.amount.toFixed(2)}</span></p>
                </div>
            `;
        };

        async function loadAdminEarnings() {
            const tbody = document.getElementById('admin-earnings-tbody');
            tbody.innerHTML = '<tr><td colspan="4" class="text-center">Loading...</td></tr>';
            const snap = await getDocs(collection(db, 'artistSecrets'));
            if (snap.empty) {
                tbody.innerHTML = '<tr><td colspan="4" class="text-center text-muted">No data</td></tr>';
                return;
            }
            let rows = '';
            for (const doc of snap.docs) {
                const data = doc.data();
                const artistSnap = await getDoc(doc(db, 'artists', data.artistId));
                const name = artistSnap.exists() ? artistSnap.data().name : 'Unknown';
                rows += `<tr>
                    <td>${name}</td>
                    <td>${data.views.toLocaleString()}</td>
                    <td>$${data.amount.toFixed(2)}</td>
                    <td><button class="btn btn-sm btn-primary" onclick="updateArtistEarnings('${data.artistId}')">Recalculate</button></td>
                </tr>`;
            }
            tbody.innerHTML = rows;
        }

        // === REST OF YOUR ORIGINAL CODE (unchanged) ===
        // ... [All your existing JS: login, artists, sliders, etc.] ...

        // Auth State
        onAuthStateChanged(auth, async (user) => {
            currentUser = user;
            if (user) {
                loginBtn.classList.add('d-none');
                logoutBtn.classList.remove('d-none');
                userInfo.innerHTML = `<i class="bi bi-person-circle"></i> ${user.email}`;
                submissionSection.classList.remove('d-none');
                earningsCheckSection.classList.remove('d-none');

                if (user.email === ADMIN_EMAIL) {
                    adminSection.classList.remove('d-none');
                    artistManagementSection.classList.remove('d-none');
                    adminEarningsSection.classList.remove('d-none');
                    loadAdminEarnings();
                    loadManagers();
                    loadSubmissions();
                }
            } else {
                loginBtn.classList.remove('d-none');
                logoutBtn.classList.add('d-none');
                userInfo.innerHTML = '';
                adminSection.classList.add('d-none');
                artistManagementSection.classList.add('d-none');
                submissionSection.classList.add('d-none');
                earningsCheckSection.classList.add('d-none');
                adminEarningsSection.classList.add('d-none');
            }
            const artistId = new URLSearchParams(window.location.search).get('artist');
            if (artistId) loadSingleArtist(artistId);
            else { loadArtists(); loadSlider(); }
        });

        // Keep all your existing functions: loadArtists, loadSingleArtist, etc.
        // ... [Paste all your original JS functions here] ...

        // Example placeholder for brevity (replace with your full code)
        window.loadArtists = () => { /* your code */ };
        window.loadSingleArtist = () => { /* your code */ };
        // ... etc

    </script>
</head>
<body>

    <!-- Top Social Bar -->
    <div class="top-social-bar">
        <div class="container">
            <div class="top-social-container">
                <div class="top-social-links">
                    <a href="https://instagram.com/sjlabel" target="_blank"><i class="bi bi-instagram"></i></a>
                    <a href="https://twitter.com/sjlabel" target="_blank"><i class="bi bi-twitter"></i></a>
                    <a href="https://tiktok.com/@sjlabel" target="_blank"><i class="bi bi-tiktok"></i></a>
                    <a href="https://facebook.com/sjlabel" target="_blank"><i class="bi bi-facebook"></i></a>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero + Slider -->
    <section id="hero" class="hero-section">
        <div class="hero-bg"></div>
        <div id="headerCarousel" class="carousel slide header-carousel" data-bs-ride="carousel">
            <div class="carousel-inner"></div>
            <button class="carousel-control-prev" data-bs-target="#headerCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
            <button class="carousel-control-next" data-bs-target="#headerCarousel" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
        </div>
        <div class="music-platforms-bar">
            <a href="https://open.spotify.com"><i class="bi bi-spotify"></i></a>
            <a href="https://music.apple.com"><i class="bi bi-music-note-beamed"></i></a>
            <a href="https://youtube.com"><i class="bi bi-youtube"></i></a>
        </div>
    </section>

    <div class="ad-container-wrapper"><div id="ad-container"></div></div>
    <div class="particles"></div>

    <div class="container">

        <!-- Auth -->
        <div id="auth-section" class="text-center my-4 glass-effect">
            <button id="login-btn" class="btn btn-primary"><i class="bi bi-google"></i> Login</button>
            <button id="logout-btn" class="btn btn-secondary d-none"><i class="bi bi-box-arrow-right"></i> Logout</button>
            <div id="user-info" class="mt-2"></div>
        </div>

        <!-- Earnings Check (Public) -->
        <div id="earnings-check-section" class="form-section d-none glass-effect">
            <h3 class="text-center mb-4"><i class="bi bi-wallet2"></i> Check Earnings</h3>
            <div class="input-group mb-3">
                <input type="text" id="secret-code" class="form-control" placeholder="Enter your secret code">
                <button class="btn btn-primary" onclick="checkEarnings()">Go</button>
            </div>
            <div id="earnings-result"></div>
        </div>

        <!-- Artists List -->
        <section id="artists" class="artist-section">
            <div id="artists-list" class="row justify-content-center artist-list"></div>
        </section>

        <!-- Admin Earnings Dashboard -->
        <div id="admin-earnings-section" class="form-section d-none glass-effect">
            <h3 class="text-center mb-4"><i class="bi bi-graph-up"></i> Earnings Dashboard</h3>
            <div class="table-responsive">
                <table class="table table-dark table-striped">
                    <thead><tr><th>Artist</th><th>Views</th><th>Earnings</th><th>Action</th></tr></thead>
                    <tbody id="admin-earnings-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- Artist Management, Submissions, etc. -->
        <!-- ... [Your existing sections] ... -->

    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <p>© 2025 SJ x N41 music. All rights reserved.</p>
        <p><a href="mailto:simo.jibou@gmail.com">simo.jibou@gmail.com</a></p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
