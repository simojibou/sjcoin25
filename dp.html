<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Printful OAuth Demo (HTML Only)</title>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<h1>Printful Integration Demo</h1>
<button id="loginPrintful">Login with Printful</button>

<script>
// بيانات التطبيق (Client ID فقط، Secret لا يجب وضعه هنا)
const CLIENT_ID = "app-9955277";
const REDIRECT_URI = window.location.href;

// 1️⃣ إعادة توجيه المستخدم لتسجيل الدخول
document.getElementById('loginPrintful').onclick = () => {
    const oauthUrl = `https://www.printful.com/oauth/authorize?client_id=${CLIENT_ID}&response_type=code&redirect_uri=${encodeURIComponent(REDIRECT_URI)}`;
    window.location.href = oauthUrl;
};

// 2️⃣ بعد العودة من Printful مع ?code=XYZ
window.onload = async () => {
    const urlParams = new URLSearchParams(window.location.search);
    const code = urlParams.get('code');
    if (!code) return;

    alert("Received OAuth code (educational only): " + code);

    // ⚠️ لا يمكن استبدال الكود بالـAccess Token مباشرة في المتصفح بدون Secret
    // الحل الحقيقي: إرسال هذا الكود إلى Server (Firebase Functions أو Node.js)
    console.log("OAuth Code:", code);
};

// ⚠️ تعليمات:
// - لإنشاء Access Token، يجب إرسال الكود مع Client Secret إلى Backend.
// - لإنشاء الطلبات (orders) يجب استخدام Access Token في Server فقط.
</script>
</body>
</html>
