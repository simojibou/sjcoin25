<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SJ Random Video Chat</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Cairo', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial; }
    video { width: 100%; height: auto; background: #000; border-radius: 1rem; }
    .glass { backdrop-filter: blur(8px); background: rgba(255,255,255,0.08); }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white">
  <header class="max-w-6xl mx-auto p-6">
    <div class="flex items-center justify-between">
      <h1 class="text-2xl sm:text-3xl font-extrabold">
        SJ <span class="text-indigo-300">Random</span> Video Chat
      </h1>
      <div class="text-xs sm:text-sm opacity-80">HTML + Firebase + WebRTC</div>
    </div>
  </header>  <main class="max-w-6xl mx-auto p-6 grid lg:grid-cols-3 gap-6">
    <section class="lg:col-span-2 space-y-6">
      <div class="grid md:grid-cols-2 gap-6">
        <div class="glass rounded-2xl p-3 shadow-xl ring-1 ring-white/10">
          <div class="flex items-center justify-between mb-2">
            <h2 class="font-semibold">فيديوك</h2>
            <span class="text-xs opacity-70" id="localStatus">🔴 غير متصل</span>
          </div>
          <video id="localVideo" autoplay playsinline muted></video>
        </div>
        <div class="glass rounded-2xl p-3 shadow-xl ring-1 ring-white/10">
          <div class="flex items-center justify-between mb-2">
            <h2 class="font-semibold">الشخص الآخر</h2>
            <span class="text-xs opacity-70" id="remoteStatus">🟡 في الإنتظار</span>
          </div>
          <video id="remoteVideo" autoplay playsinline></video>
        </div>
      </div><div class="glass rounded-2xl p-4 shadow-xl ring-1 ring-white/10 flex flex-wrap items-center gap-3">
    <button id="btnStart" class="px-4 py-2 rounded-2xl bg-indigo-500 hover:bg-indigo-600 transition font-semibold">تشغيل الكاميرا/المايك</button>
    <button id="btnCreate" class="px-4 py-2 rounded-2xl bg-emerald-500 hover:bg-emerald-600 transition font-semibold disabled:opacity-40" disabled>إنشاء غرفة</button>
    <button id="btnJoin" class="px-4 py-2 rounded-2xl bg-sky-500 hover:bg-sky-600 transition font-semibold disabled:opacity-40" disabled>انضمام لغرفة</button>
    <button id="btnNext" class="px-4 py-2 rounded-2xl bg-fuchsia-500 hover:bg-fuchsia-600 transition font-semibold disabled:opacity-40" disabled>التالي (Random)</button>
    <button id="btnHangup" class="px-4 py-2 rounded-2xl bg-rose-500 hover:bg-rose-600 transition font-semibold disabled:opacity-40" disabled>إنهاء</button>
    <div class="ml-auto text-xs opacity-80">Room ID: <code id="roomIdDisp">-</code></div>
  </div>

  <div class="glass rounded-2xl p-4 shadow-xl ring-1 ring-white/10">
    <h3 class="font-semibold mb-2">سجل الأحداث (Debug)</h3>
    <div id="log" class="text-sm max-h-48 overflow-auto whitespace-pre-wrap"></div>
  </div>
</section>

<aside class="space-y-6">
  <div class="glass rounded-2xl p-5 shadow-xl ring-1 ring-white/10">
    <h3 class="font-semibold mb-3">الدخول إلى غرفة</h3>
    <label class="text-sm opacity-80">أدخل معرف الغرفة</label>
    <input id="roomIdInput" class="mt-1 w-full px-4 py-2 rounded-xl bg-white/5 border border-white/10 outline-none focus:ring-2 focus:ring-indigo-500" placeholder="مثال: abc123" />
    <p class="text-xs opacity-70 mt-2">أو أنشئ غرفة جديدة ثم شارك المعرف.</p>
  </div>
  <div class="glass rounded-2xl p-5 shadow-xl ring-1 ring-white/10">
    <h3 class="font-semibold mb-2">ملاحظات مهمة</h3>
    <ul class="list-disc pr-5 space-y-2 text-sm opacity-90">
      <li>هذا نموذج تعليمي يستخدم <strong>WebRTC</strong> و <strong>Firestore</strong> كقناة إشارة.</li>
      <li>لأفضل توافق، يُنصح بإعداد خادم <strong>TURN</strong>.</li>
      <li>قم بتمكين <strong>تسجيل دخول مجهول</strong> في Firebase.</li>
    </ul>
  </div>
  <div class="glass rounded-2xl p-5 shadow-xl ring-1 ring-white/10 text-xs opacity-80">
    <h4 class="font-semibold mb-2">Firestore Security Rules</h4>

<pre class="whitespace-pre-wrap">rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /rooms/{roomId} {
      allow read, create, update, delete: if request.auth != null;
      match /callerCandidates/{doc} { allow read, write: if request.auth != null; }
      match /calleeCandidates/{doc} { allow read, write: if request.auth != null; }
    }
  }
}
</pre></div>
</aside>

  </main>  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCw46Dkka-64h7Rc3VIS9fZmvrfvbUCTjY",
      authDomain: "metawarefare-gaming.firebaseapp.com",
      databaseURL: "https://metawarefare-gaming-default-rtdb.firebaseio.com",
      projectId: "metawarefare-gaming",
      storageBucket: "metawarefare-gaming.appspot.com",
      messagingSenderId: "551352148152",
      appId: "1:551352148152:web:1b8fe7257e19fba720d44d"
    };

    // بقية كود WebRTC + Firestore يبقى كما هو من النسخة السابقة
  </script></body>
</html>
